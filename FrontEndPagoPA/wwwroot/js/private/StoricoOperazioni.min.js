function FiltraRichieste(){$(".preload").show();let n={dataInizio:$("#dataInizio").val(),dataFine:$("#dataFine").val(),page:1,itemsPerPage:itemsPerPage};$.post("/Action/FiltraRichiesteStoricoOperazioni",n,function(t){let i=JSON.parse(t);GetRichieste(i.Result);CreatePaginations(n.dataInizio,n.dataFine,!0)})}function GetRichiestePerPage(n,t){let i=$("#dataInizio").val(),r=$("#dataFine").val();$(".items").removeClass("selected");$(".item-"+n).addClass("selected");$.get("/Action/GetStoricoOperazioni?page="+n+"&itemsPerPage="+itemsPerPage+"&dataInizio="+i+"&dataFine="+r,function(n){var u=JSON.parse(n);GetRichieste(u.Result);t&&CreatePaginations(i,r,t);$(".preload").hide()})}function CreatePaginations(n,t,i){$.get("/Action/GetStoricoOperazioni?page=1&itemsPerPage=1000000000&dataInizio="+n+"&dataFine="+t,function(n){var u=JSON.parse(n),r=u.Message,t;if($(".pagination").empty(),r>0){let n="<a onclick='GetRichiestePerPage(1)'><i class='las la-angle-left'><\/i><\/a>",u=Math.ceil(r/itemsPerPage);for(t=0;t<u;t++)n+="<a onclick='GetRichiestePerPage("+(t+1)+")' class='items item-"+(t+1)+"'>"+(t+1)+"<\/a>";n+="<a onclick='GetRichiestePerPage("+u+")'><i class='las la-angle-right'><\/i><\/a>";$(".pagination").append(n);i&&($(".items").removeClass("selected"),$(".item-1").addClass("selected"))}})}function EliminaFiltro(){$(".preload").show();let n=$("#dataInizio"),t=$("#dataFine");$.get("/Action/EliminaFiltroStoricoOperazioni",function(i){var r=JSON.parse(i);n.val(today);t.val("");GetRichiestePerPage(1,!0)})}function GetRichieste(n){var t,i;if($(".operations-history").empty(),n!=null)if(n.length>0)for(t=0;t<n.length;t++){let r=new Date(n[t].date),u=r.toLocaleDateString("it-IT",{year:"numeric",month:"2-digit",day:"2-digit"});i="<ul><li>"+n[t].title+"<\/li><li class='text-center'>"+u+"<\/li><li class='text-center'>"+n[t].operationType+"<\/li>";i+=n[t].bollettino==!1||n[t].bollettino==""||n[t].bollettino==null?"<li class='text-center'>IUV<\/li>":"<li class='text-center'>IUV + Bollettino<\/li>";i+="<li class='text-center'><div class='progress-bar'><div style='width:100%; position:absolute; z-index:200; text-align:center; color:#FFF; font-weight:600;'>"+n[t].workedInstallmentsPercentage+"%<\/div><span style='width:"+n[t].workedInstallmentsPercentage+"%'><\/span><\/div><\/li>";n[t].workedInstallmentsPercentage==100?(i+="<li class='text-center' title='documento disponibile' onclick='GetCsv("+n[t].operationId+")'><i class='bx bx-qr active-btn'><\/i><\/li>",i+=n[t].bollettino==!1||n[t].bollettino==""||n[t].bollettino==null?"<li class='text-center' title='nessuna azione possibile'>-<\/li>":n[t].downloadableFile?"<li class='text-center' title='documento disponibile' onclick='GetZipFile("+n[t].operationId+")'><i class='las la-file-archive active-btn'><\/i><\/li>":"<li class='text-center' title='documento non ancora disponibile'><i class='las la-file-archive not-active'><\/i><\/li>"):(i+="<li class='text-center' title='documento non ancora disponibile'><i class='bx bx-qr not-active'><\/i><\/li>",i+=n[t].bollettino==!1||n[t].bollettino==""||n[t].bollettino==null?"<li class='text-center' title='nessuna azione possibile'>-<\/li>":"<li class='text-center' title='documento non ancora disponibile'><i class='las la-file-archive not-active'><\/i><\/li>");i+="<\/ul>";$(".operations-history").append(i)}else $(".operations-history").append("<ul><li style='width:100%; text-align: center; padding:10px'> Nessuna richiesta trovata <\/li><\/ul>");else $(".operations-history").append("<ul><li style='width:100%; text-align: center; padding:10px'> Nessuna richiesta trovata <\/li><\/ul>");$(".preload").hide()}function GetCsv(n){$(".preload").show();const t=document.createElement("iframe");t.style.display="none";document.body.appendChild(t);$.get("/Action/GetCsvFromOperation?id="+n,function(n){t.src=n}).done(function(){$(".preload").hide()})}function GetZipFile(n){$(".preload").show();const t=document.createElement("iframe");t.style.display="none";document.body.appendChild(t);$.get("/Action/GetFileFromOperation?id="+n,function(n){t.src=n}).done(function(){$(".preload").hide()})}let itemsPerPage=100;var currentDate=new Date,today=currentDate.toISOString().split("T")[0];$(function(){$(".preload").show();GetRichiestePerPage(1,!0)});