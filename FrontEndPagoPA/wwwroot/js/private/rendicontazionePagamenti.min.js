function loadOperationTypes(){return $.get("/Action/GetOperationTypes").then(n=>{n=JSON.parse(n),n&&n.IsSuccess&&(operationTypes=n.Result.reduce((n,t)=>(n[t.id]=t.typeName,n),{}))}).catch(n=>{console.error("Error fetching operation types:",n)})}function CheckOperationTypeId(n){return operationTypes[n]||""}function FiltraRichieste(){$(".preload").show();let n={dataInizio:$("#dataInizio").val(),dataFine:$("#dataFine").val(),worked:$("#worked").val(),valid:$("#valid").val(),nominativo:$("#nominativo").val(),codiceFiscale:$("#codiceFiscale").val(),iuv:$("#iuv").val(),importoMin:$("#importoMinimo").val(),importoMax:$("#importoMassimo").val(),paid:$("#pagato").val(),page:1,itemsPerPage:itemsPerPage,payable:!1};n.paid=="NO"?(n.paid=!1,n.payable=!0):n.paid=!0;let t=$("#nominativo").val(),i=$("#dataInizio").val(),r=$("#dataFine").val();$.post("/Action/FiltraRichieste",n,function(t){let i=JSON.parse(t);GetRichieste(i.Result);CreatePaginations(n.paid,n.nominativo,n.dataInizio,n.dataFine,n.iuv,n.codiceFiscale,n.importoMin,n.importoMax,!0)})}function GeneraCsv(){let t={dataInizio:$("#dataInizio").val(),dataFine:$("#dataFine").val(),nominativo:$("#nominativo").val(),paid:$("#pagato").val(),iuv:$("#iuv").val(),codiceFiscale:$("#codiceFiscale").val(),importoMin:$("#importoMinimo").val(),importoMax:$("#importoMassimo").val()};$(".preload").show();const n=document.createElement("iframe");n.style.display="none";document.body.appendChild(n);$.post("/Action/GeneraRendicontazione",t,function(t){n.src=t}).done(function(){$(".preload").hide()})}function GetRichiestePerPage(n,t){let i=$("#pagato").val(),r;i=="NO"?(i=!1,r=!0):(i=!0,r=!1);let u=$("#nominativo").val(),f=$("#dataInizio").val(),e=$("#dataFine").val(),o=$("#iuv").val(),s=$("#codiceFiscale").val(),h=$("#importoMinimo").val(),c=$("#importoMassimo").val();$(".items").removeClass("selected");$(".item-"+n).addClass("selected");$.get("/Action/GetRendicontazionePagamenti?page="+n+"&itemsPerPage="+itemsPerPage+"&paid="+i+"&nominativo="+u+"&dataInizio="+f+"&dataFine="+e+"&iuv="+o+"&codiceFiscale="+s+"&importoMin="+h+"&importoMax="+c+"&payable="+r,function(n){var r=JSON.parse(n);GetRichieste(r.Result);t&&CreatePaginations(i,u,f,e,o,s,h,c,t);$(".preload").hide()})}function CreatePaginations(n,t,i,r,u,f,e,o,s){let h=!1;n==!1&&(h=!0);let c="/Action/GetRendicontazionePagamenti?page=1&itemsPerPage=1000000000&paid="+n+"&nominativo="+t+"&dataInizio="+i+"&dataFine="+r+"&iuv="+u+"&codiceFiscale="+f+"&importoMin="+e+"&importoMax="+o+"&payable="+h;$.get(c,function(n){var r=JSON.parse(n),i=r.Message,t;if($(".pagination").empty(),i>0){let n="<a onclick='GetRichiestePerPage(1)'><i class='las la-angle-left'><\/i><\/a>",r=Math.ceil(i/itemsPerPage);for(t=0;t<r;t++)n+="<a onclick='GetRichiestePerPage("+(t+1)+")' class='items item-"+(t+1)+"'>"+(t+1)+"<\/a>";n+="<a onclick='GetRichiestePerPage("+r+")'><i class='las la-angle-right'><\/i><\/a>";n+=i==1?"<span>  1 Risultato <\/span>":"<span>  "+i+" Risultati<\/span>";$(".pagination").append(n);s&&($(".items").removeClass("selected"),$(".item-1").addClass("selected"))}})}function EliminaFiltro(){$(".preload").show();let n=$("#dataInizio"),t=$("#dataFine"),i=$("#nominativo"),r=$("#iuv"),u=$("#pagato"),f=$("#codiceFiscale"),e=$("#importoMinimo"),o=$("#importoMassimo");$.get("/Action/EliminaFiltroRendicontazione",function(s){var h=JSON.parse(s);n.val(today);t.val("");i.val("");r.val("");f.val("");e.val("");o.val("");u.val("SI");GetRichiestePerPage(1,!0)})}function GetRichieste(n){var t,i;if($(".archive-payments").empty(),n!=null)if(n.length>0)for(t=0;t<n.length;t++){let r="Rata unica",o=new Date(n[t].expirationDate),u={year:"numeric",month:"2-digit",day:"2-digit"},s=o.toLocaleDateString("it-IT",u),f=CheckOperationTypeId(n[t].operationTypeId),e="";if(n[t].paid==!0){let i=new Date(n[t].paymentDate);e=i.toLocaleDateString("it-IT",u)}n[t].numeroRata!=0&&(r=n[t].numeroRata);i="<ul><li>"+n[t].anagraficaPagatore+"<\/li><li>"+n[t].codiceIdentificativoUnivocoPagatore+"<\/li><li>"+n[t].iuv+"<\/li><li>"+f+"<\/li><li>"+n[t].price+"â‚¬<\/li>";i+=f=="Multa"?"<li>"+n[t].description+"<\/li>":"<li>"+r+"<\/li>";i+="<li class='text-center'>"+s+"<\/li>";i+=n[t].paid==!0?"<li class='text-center'><a href='#'><i class='bx bxs-check-square'><\/i><\/a><\/li>":"<li class='text-center'><a href='#'><i class='bx bx-x'><\/i><\/a><\/li>";i+="<li class='text-center'>"+e+"<\/li>";i+="<\/ul>";$(".archive-payments").append(i)}else $(".archive-payments").append("<ul><li style='width:100%; text-align: center; padding:10px'> Nessuna richiesta trovata <\/li><\/ul>");else $(".archive-payments").append("<ul><li style='width:100%; text-align: center; padding:10px'> Nessuna richiesta trovata <\/li><\/ul>");$(".preload").hide()}let itemsPerPage=100,currentDate=new Date,today=currentDate.toISOString().split("T")[0],operationTypes={};loadOperationTypes();$(function(){$(".preload").show();GetRichiestePerPage(1,!0)});